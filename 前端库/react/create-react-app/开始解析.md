# 开始解析

把`create-react-app`仓库clone下来后，在package.json中发现了很多脚本，

```
"scripts": {
    "build": "cd packages/react-scripts && node bin/react-scripts.js build",
    "changelog": "lerna-changelog",
    "create-react-app": "node tasks/cra.js",
    "e2e": "tasks/e2e-simple.sh",
    "e2e:docker": "tasks/local-test.sh",
    "postinstall": "cd packages/react-error-overlay/ && yarn build:prod",
    "publish": "tasks/publish.sh",
    "start": "cd packages/react-scripts && node bin/react-scripts.js start",
    "screencast": "node ./tasks/screencast.js",
    "screencast:error": "svg-term --cast jyu19xGl88FQ3poMY8Hbmfw8y --out screencast-error.svg --window --at 12000 --no-cursor",
    "test": "cd packages/react-scripts && node bin/react-scripts.js test",
    "format": "prettier --trailing-comma es5 --single-quote --write 'packages/*/*.js' 'packages/*/!(node_modules)/**/*.js'",
    "compile:lockfile": "node tasks/compile-lockfile.js"
  }
```

这边应该是采用下面这条:

```
"create-react-app": "node tasks/cra.js",
```

所以执行的是tasks中的`cra.js`脚本。

在`cra.js`脚本中，最后调用`packages/create-react-app/index.js`脚本



通过下面的命令来创建模版

```
npx create-react-app my-app
```



### packages

create-react-app-next目录下的packages有如下依赖包：

* babel-plugin-named-asset-import
* babel-preset-react-app
* confusing-brwoser-globals
* create-react-app
* eslint-config-react-app
* react-dev-utils
* React-error-overlay
* react-scripts



### npx

npx这条命令会临时安装 `create-react-app` 包，命令完成后`create-react-app` 会删掉，不会出现在 global 中。下次再执行，还是会重新临时安装。

npx 会帮你执行依赖包里的二进制文件。



```
"bin": {
	"create-react-app": "./index.js"
}
```

所以会执行`packages/create-react-app/index.js`文件



### yarn

```
yarn  create react-app my-app

上面的命令==下面的两行命令
yarn global add create-react-app
create-react-app my-app

yarn create <starter-kit-package> [<args>]
```

`yarn create`： This command is a shorthand that helps you do two things at once:

* Insall `create-<starter-kit-package> `globally, or update the package to the latest version if it already exists.
* Run the executable located in the `bin` field of the starter kit's package.json, forwarding any <args> to it.





其实全局安装的`creat-react-app`很容易受到影响，所以这边的create-react-app初始化仓库之后，就是把所有的命令都转向当前本地版本的`create-react-app`

the only job of `create-react-app` is to init the repository(初始化仓库) and then forward all the commands to the local version of create-react-app.

